<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold | Franz Louis Cesista</title>
<meta name="keywords" content="Machine Learning, Optimizers">
<meta name="description" content="Fast, numerically stable, and differentiable solution for steepest descent on Stiefel manifold.">
<meta name="author" content="Franz Louis Cesista">
<link rel="canonical" href="https://leloykun.github.io/ponder/steepest-descent-stiefel/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e50e51e1b615f62676c32fb60e15e4b5e3a80ade29f3c6f9c953c528f576fb9f.css" integrity="sha256-5Q5R4bYV9iZ2wy&#43;2DhXkteOoCt4p88b5yVPFKPV2&#43;58=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://leloykun.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://leloykun.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://leloykun.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://leloykun.github.io/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://leloykun.github.io/ponder/steepest-descent-stiefel/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold" />
<meta property="og:description" content="Fast, numerically stable, and differentiable solution for steepest descent on Stiefel manifold." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://leloykun.github.io/ponder/steepest-descent-stiefel/" />
<meta property="og:image" content="https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold.jpg" /><meta property="article:section" content="ponder" />
<meta property="article:published_time" content="2025-07-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-07-18T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold.jpg" />
<meta name="twitter:title" content="A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold"/>
<meta name="twitter:description" content="Fast, numerically stable, and differentiable solution for steepest descent on Stiefel manifold."/>
<meta name="twitter:site" content="@leloykun"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Ponder",
      "item": "https://leloykun.github.io/ponder/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold",
      "item": "https://leloykun.github.io/ponder/steepest-descent-stiefel/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold",
  "name": "A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold",
  "description": "Fast, numerically stable, and differentiable solution for steepest descent on Stiefel manifold.",
  "keywords": [
    "Machine Learning", "Optimizers"
  ],
  "articleBody": " If you find this post useful, please consider supporting my work by sponsoring me on GitHub: This is still a Work in Progress (WIP). I’ve decided to publish this earlier than planned to get feedback and iterate quickly. If you spot any mistakes, please don’t hesitate to let me know! Email me at franzlouiscesista@gmail.com or tag me on X (@leloykun).\nSteepest descent on Stiefel manifold Consider a weight matrix $W \\in \\mathbb{R}^{m \\times n}$ that is semi-orthogonal, i.e., $W^T W = I_n$. Note that $W \\in \\text{St}(m, n)$, the Stiefel manifold of $m \\times n$ semi-orthogonal matrices. Given a “raw gradient” or differential $G \\in \\mathbb{R}^{m \\times n}$, we want to find the steepest descent direction on the Stiefel manifold, i.e., we want to find a matrix $A^* \\in \\mathbb{R}^{m \\times n}$ such that, $$A^* = \\arg\\max_{\\| A \\|_{2 \\to 2} = 1} \\text{tr}(G^T A) \\quad \\text{s.t. } W^T A + A^T W = 0.$$ In words, we want to find a unit spectral norm matrix $A$ that is in the tangent space at $W$ and maximizes the “alignment” with the raw gradient $G$.\nEquivalence between Bernstein’s and Su’s solutions Bernstein (2025) and Su (2025) found the following solutions to the square and full-rank case,\n$$\\begin{align*} A^*_{\\text{bernstein}} \u0026= W \\texttt{msign}(\\texttt{skew}(W^TG))\\\\ A^*_{\\text{su}} \u0026= \\texttt{msign}(G - W\\texttt{sym}(W^T G)) \\end{align*}$$\nWe will show that these are equivalent, i.e., $A^*_{\\text{bernstein}} = A^*_{\\text{su}}$. For this, we will reuse the following proposition we have discussed in a previous post on spectral clipping.\nProposition1 (Transpose Equivariance and Unitary Multiplication Equivariance of Odd Matrix Functions). Let $W \\in \\mathbb{R}^{m \\times n}$ and $W = U \\Sigma V^T$ be its reduced SVD. And let $f: \\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{m \\times n}$ be an odd analytic matrix function that acts on the singular values of $W$ as follows, $$f(W) = U f(\\Sigma) V^T.$$ Then $f$ is equivariant under transposition and unitary multiplication, i.e., $$f(W^T) = f(W)^T \\quad\\text{and}\\quad f(WQ^T) = f(W)Q^T \\quad\\text{and}\\quad f(Q^TW) = Q^Tf(W)$$ for all $Q \\in \\mathbb{R}^{m \\times n}$ such that $Q^TQ = I$.\nThus,\n$$\\begin{align*} A^*_{\\text{bernstein}} \u0026= W \\texttt{msign}(\\texttt{skew}(W^TG)) \\\\ \u0026= \\texttt{msign}(W \\texttt{skew}(W^TG)) \u0026\\text{(from Proposition 1)} \\\\ \u0026= \\texttt{msign}\\left(\\frac{1}{2}W W^T G - \\frac{1}{2}W G^T W \\right) \\\\ \u0026= \\texttt{msign}\\left(W W^T G - \\frac{1}{2}W W^T G - \\frac{1}{2}W G^T W \\right) \\\\ \u0026= \\texttt{msign}\\left(G - W\\texttt{sym}(W^T G) \\right) \\\\ A^*_{\\text{bernstein}} \u0026= A^*_{\\text{su}} \\end{align*}$$ where the second-to-last equality relies on $W$ being square and full-rank (which then implies that $W W^T = I_m$).\nProjection-projection perspective One can interpret Bernstein’s and Su’s solutions as a two-step projection process:\n(Orthogonal) projection to the tangent space at $W$; and Projection to the closest semi-orthogonal matrix. This is because the map $G \\to G - W \\texttt{sym}(W^T G)$ is actually the orthogonal projection onto the tangent space at $W$ and that $\\texttt{msign}$ projects the resulting matrix to the closest semi-orthogonal matrix. We present these more rigorously as follows.\nTheorem 2 (Orthogonal projection to the tangent space at $W$). Let $W \\in \\text{St}(m, n)$ be a point on the Stiefel manifold. The projection of a vector $V \\in \\mathbb{R}^{m \\times n}$ onto the tangent space at $W$, denoted as $T_W\\text{St}(m, n)$ , is given by, $$\\begin{equation} \\texttt{proj}_{T_W\\text{St}(m, n)}(V) = V - W \\text{sym}(W^T V) \\end{equation}$$\nShow proof of Theorem 2 Proof. First, we need to show that the normal space at $W$, $\\text{NS}_W$ is given by, $$\\text{NS}_W = \\{WS | S = S^T\\}$$ for symmetric $S$. To show this, let $A \\in T_W\\text{St}(m, n)$ be an arbitrary tangent vector at $W$. Then we have, $$\\begin{align*} \\langle A, WS \\rangle \u0026= \\text{tr}(A^T WS) \\\\ \u0026= \\text{tr}(S W^T A) \u0026\\text{(transpose invariance of trace)} \\\\ \u0026= -\\text{tr}(S A^T W) \u0026\\text{(since $A \\in T_W\\text{St}(m, n)$)} \\\\ \u0026= -\\text{tr}(A^T W S) \u0026\\text{(cyclic property of trace)} \\\\ \\langle A, WS \\rangle \u0026= -\\langle A, WS \\rangle \\end{align*}$$ Thus $\\langle A, WS \\rangle = 0$ which implies that $A$ and $WS$ are orthogonal. Hence $WS \\in \\text{NS}_W$.\nNow, for any $V \\in \\mathbb{R}^{m \\times n}$, we can write it as, $V = \\underbrace{V - WS}_{\\text{candidate tangent}} + \\underbrace{WS}_{\\text{candidate normal}}$ for some symmetric $S$. To find $S$, $$\\begin{align*} W^T (V - WS) + (V - WS)^T W \u0026= 0 \\\\ W^T V - S + V^TW - S \u0026= 0 \\\\ S \u0026= \\text{sym}(W^T V) \\end{align*}$$ Thus, $V - W \\text{sym}(W^T V) \\in T_W\\text{St}(m, n)$. And because of that, $W^T (V - W \\text{sym}(W^T V))$ must be skew-symmetric. Thus, $$\\begin{equation*} \\langle V - WS, WS \\rangle = \\langle \\underbrace{W^T (V - WS)}_{\\text{skew-symmetric}}, \\underbrace{S}_{\\text{symmetric}} \\rangle = 0 \\end{equation*}$$ Hence, $V - W \\text{sym}(W^T V)$ is the orthogonal projection of $V$ onto the tangent space at $W$.\nAnd from Proposition 4 of Bernstein \u0026 Newhouse (2024),\nProposition 3 (Projection to the closest semi-orthogonal matrix). Consider the orthogonal matrices $\\mathcal{O}_{m \\times n} := \\{ A \\in \\mathbb{R}^{m \\times n} : A A^T = I_m or A^T A = I_n \\}$ and let $\\| \\cdot \\|_F$ denote the Frobenius norm. For any matrix $G \\in R^{m \\times n}$ with reduced SVD $G = U \\Sigma V^T$: $$\\arg\\min_{A \\in \\mathcal{O}_{m \\times n}} \\| A - G \\|_F = \\texttt{msign}(G) = UV^T,$$ where the minizer $UV^T$ is unique if and only if the matrix $G$ has full rank.\nThus we can write, $$A^*_{\\text{bernstein}} = A^*_{\\text{su}} = (\\texttt{msign} \\circ \\texttt{proj}_{T_W\\text{St}(m, n)})(G)$$\nWhy Bernstein’s \u0026 Su’s solutions only work for the square and full-rank case Note that the projections above aim to guarantee both of our criteria for the solution, but one step at a time. And that the $\\texttt{msign}$ after the projection may send the resulting matrix outside the tangent space at $W$. We show that this is not a problem in the square and full-rank case, but it is in the general case.\noperation on the tangent space at $W$? have unit spectral norm? (input $G$) not in general not in general 1st projection ($\\texttt{proj}_{T_W St(m, n)}(\\cdot)$) ${\\color{green}\\text{yes}}$ not necessarily 2nd projection ($\\texttt{msign}(\\cdot$)) only for the square\nand full-rank case ${\\color{green}\\text{yes}}$ To demonstrate this, we will need the following proposition.\nProposition 4 ($\\texttt{msign}$ preserves skew-symmetry). Let $X \\in \\R^{m \\times n}$ be a skew-symmetric matrix. Then $\\texttt{msign}(X)$ is also skew-symmetric.\nThe proof follows directly from the transpose equivariance and oddness of $\\texttt{msign}$, i.e., $\\texttt{msign}(X) = \\texttt{msign}(-X^T) = -\\texttt{msign}(X)^T$.\nAlso note that for the general case, $$\\begin{equation} WW^T + QQ^T = I_m \\quad\\text{and}\\quad W^T Q = 0 \\end{equation}$$ where $Q$ is the orthogonal complement of $W$.\nThus, $$\\begin{align*} (\\texttt{msign}\\circ \\texttt{proj}_{T_W St(m, n)})(G) \u0026= \\texttt{msign}(G - \\frac{1}{2}W W^T G - \\frac{1}{2} W G^T W) \\\\ \u0026= \\texttt{msign}((WW^T + QQ^T)G - \\frac{1}{2}W W^T G - \\frac{1}{2} W G^T W) \\\\ \u0026= \\texttt{msign}(W \\texttt{skew}(W^T G) + QQ^T G) \\end{align*}$$ For the square and full-rank case, we have $Q = 0$. And the above simplifies to Berstein’s solution, $$(\\texttt{msign}\\circ \\texttt{proj}_{T_W St(m, n)})(G) = W \\texttt{msign}(\\texttt{skew}(W^T G))$$ and since $\\texttt{skew}(W^T G)$ is skew-symmetric, then $\\texttt{msign}(\\texttt{skew}(W^T G))$ must be too. And thus, $$\\begin{align*} \u0026W^T (\\texttt{msign}\\circ \\texttt{proj}_{T_W St(m, n)})(G) + (\\texttt{msign}\\circ \\texttt{proj}_{T_W St(m, n)})(G)^T W \\\\ \u0026\\qquad= W^T W \\texttt{msign}(\\texttt{skew}(W^T G)) + (W\\texttt{msign}(\\texttt{skew}(W^T G)))^T W \\\\ \u0026\\qquad= \\texttt{msign}(\\texttt{skew}(W^T G)) + \\texttt{msign}(\\texttt{skew}(W^T G))^T \\\\ \u0026\\qquad= 0 \\end{align*}$$ Hence for the square and full-rank case, this two-step projection process guarantees that the resulting matrix has unit spectral norm and is in the tangent space at $W$.\nFor the more general case, we have $Q \\neq 0$. Thus, we cannot guarantee that $W \\texttt{skew}(W^T G) + QQ^T G$ is skew-symmetric. And so the $\\texttt{msign}$ after the projection may send the resulting matrix outside the tangent space at $W$.\nHeuristic solution for the general case [Under Construction] Notice that $QQ^T G$ is the projection of $G$ onto the column space of $Q$, $\\texttt{proj}_{\\text{col}(Q)}(G) = QQ^T G$. One can think of this as the component of $G$ that is not in the span of $W$. In practice, this is typically small relative to the component of $G$ that is in the span of $W$. If so, then, $$(\\texttt{msign}\\circ \\texttt{proj}_{T_W St(m, n)})(G) \\approx \\texttt{msign}(W \\texttt{skew}(W^T G) + \\cancel{\\texttt{proj}_{\\text{col}(Q)}(G)})$$ which means that while the resulting matrix after the two projections may not be in the tangent space at $W$, it would likely be nearby. And repeating this process a few times should close the gap.\nHere’s a sample implementation,\ndef project_to_stiefel_tangent_space(X, delta_X): return delta_X - X @ sym(X.T @ delta_X) def orthogonalize(X): # copy Newton-Schulz iteration from Muon (Jordan et al., 2024) def steepest_descent_stiefel_manifold_heuristic(W, G, num_steps=1): assert num_steps \u003e 0, \"Number of steps must be positive\" A_star = G for _ in range(num_steps): A_star = project_to_stiefel_tangent_space(W, A_star) A_star = orthogonalize(A_star) return A_star Results [Under Construction] How to cite @misc{cesista2025spectralclipping, author = {Franz Louis Cesista}, title = {\"A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold\"}, year = {2025}, url = {http://leloykun.github.io/ponder/steepest-descent-stiefel/}, } If you find this post useful, please consider supporting my work by sponsoring me on GitHub: References Jeremy Bernstein (2025). Orthogonal manifold. URL https://docs.modula.systems/algorithms/manifold/orthogonal/ Jianlin Su (2025). Steepest descent on Stiefel manifold. URL https://x.com/YouJiacheng/status/1945522729161224532 Jeremy Bernstein, Laker Newhouse (2024). Old Optimizer, New Norm: An Anthology. URL https://arxiv.org/abs/2409.20325 Keller Jordan, Yuchen Jin, Vlado Boza, Jiacheng You, Franz Cesista, Laker Newhouse, and Jeremy Bernstein (2024). Muon: An optimizer for hidden layers in neural networks. Available at: https://kellerjordan.github.io/posts/muon/ ",
  "wordCount" : "1516",
  "inLanguage": "en",
  "image":"https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold.jpg","datePublished": "2025-07-18T00:00:00Z",
  "dateModified": "2025-07-18T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Franz Louis Cesista"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://leloykun.github.io/ponder/steepest-descent-stiefel/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Franz Louis Cesista",
    "logo": {
      "@type": "ImageObject",
      "url": "https://leloykun.github.io/favicon.ico"
    }
  }
}
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-BWCGBRX8G1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BWCGBRX8G1');
</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"
  integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"
  integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"
  integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
        { left: "\\begin{equation}", right: "\\end{equation}", display: true },
        { left: "\\begin{equation*}", right: "\\end{equation*}", display: true },
        { left: "\\begin{align}", right: "\\end{align}", display: true },
        { left: "\\begin{align*}", right: "\\end{align*}", display: true },
        { left: "\\begin{alignat}", right: "\\end{alignat}", display: true },
        { left: "\\begin{gather}", right: "\\end{gather}", display: true },
        { left: "\\begin{CD}", right: "\\end{CD}", display: true },
      ],
      throwOnError: false,
      trust: (context) => ['\\htmlId', '\\href'].includes(context.command),
      macros: {
        "\\eqref": "\\href{###1}{(\\text{#1})}",
        "\\ref": "\\href{###1}{\\text{#1}}",
        "\\label": "\\htmlId{#1}{}"
      }
    });
  });
</script>
 


</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://leloykun.github.io/" accesskey="h" title="Franz Louis Cesista">
                <img src="https://leloykun.github.io/favicon.ico" alt="" aria-label="logo"
                    height="18"
                    width="18">Franz Louis Cesista</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://leloykun.github.io/cv.pdf" title="CV">
                    <span>CV</span>
                </a>
            </li>
            <li>
                <a href="https://leloykun.github.io/papers/" title="Papers">
                    <span>Papers</span>
                </a>
            </li>
            <li>
                <a href="https://leloykun.github.io/personal-projects/" title="Personal Projects">
                    <span>Personal Projects</span>
                </a>
            </li>
            <li>
                <a href="https://leloykun.github.io/ponder/" title="Ponder (Posts)">
                    <span>Ponder (Posts)</span>
                </a>
            </li>
        </ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold
    </h1>
    <div class="post-meta"><span title='2025-07-18 00:00:00 +0000 UTC'>July 18, 2025</span>&nbsp;&middot;&nbsp;Franz Louis Cesista&nbsp;&middot;&nbsp;<a href="https://x.com/leloykun/status/1946640155655475316" rel="noopener noreferrer" target="_blank">Crossposted on X (formerly Twitter)</a>

</div>
  </header> 
<figure class="entry-cover">
            <img loading="eager"
                srcset='https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold_hu96f70d7508379ec217e7a2e241ae6f20_56654_360x0_resize_q75_box.jpg 360w,https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold_hu96f70d7508379ec217e7a2e241ae6f20_56654_480x0_resize_q75_box.jpg 480w,https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold_hu96f70d7508379ec217e7a2e241ae6f20_56654_720x0_resize_q75_box.jpg 720w,https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold_hu96f70d7508379ec217e7a2e241ae6f20_56654_1080x0_resize_q75_box.jpg 1080w,https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold_hu96f70d7508379ec217e7a2e241ae6f20_56654_1500x0_resize_q75_box.jpg 1500w,https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold.jpg 1512w'
                src="https://leloykun.github.io/ponder/steepest-descent-stiefel/steepest-descent-stiefel-manifold.jpg"
                sizes="(min-width: 768px) 720px, 100vw"
                width="1512" height="816"
                alt="Cover">
        
</figure><div class="toc">
    <details  open>
        <summary accesskey="c">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#steepest-descent-on-stiefel-manifold">Steepest descent on Stiefel manifold</a></li>
    <li><a href="#equivalence-between-bernsteins-and-sus-solutions">Equivalence between Bernstein&rsquo;s and Su&rsquo;s solutions</a></li>
    <li><a href="#projection-projection-perspective">Projection-projection perspective</a>
      <ul>
        <li><a href="#why-bernsteins--sus-solutions-only-work-for-the-square-and-full-rank-case">Why Bernstein&rsquo;s &amp; Su&rsquo;s solutions only work for the square and full-rank case</a></li>
        <li><a href="#heuristic-solution-for-the-general-case-under-construction">Heuristic solution for the general case [Under Construction]</a></li>
      </ul>
    </li>
    <li><a href="#results-under-construction">Results [Under Construction]</a></li>
    <li><a href="#how-to-cite">How to cite</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><blockquote>
<p>If you find this post useful, please consider supporting my work by sponsoring me on GitHub: <a href="https://github.com/sponsors/leloykun" target="_blank"><img alt="Sponsor on GitHub" loading="lazy" src="https://img.shields.io/badge/%F0%9F%A4%9D-Sponsor%20me-1da1f2?logo=github&style=flat-square"></a></p>
</blockquote>
<blockquote>
<p>This is still a Work in Progress (WIP). I&rsquo;ve decided to publish this earlier than planned to get feedback and iterate quickly. If you spot any mistakes, please don&rsquo;t hesitate to let me know! Email me at <a href="mailto:franzlouiscesista@gmail.com">franzlouiscesista@gmail.com</a> or tag me on X (<a href="https://x.com/leloykun" target="_blank">@leloykun</a>).</p>
</blockquote>
<h2 id="steepest-descent-on-stiefel-manifold">Steepest descent on Stiefel manifold<a hidden class="anchor" aria-hidden="true" href="#steepest-descent-on-stiefel-manifold">#</a></h2>
<p>Consider a weight matrix $W \in \mathbb{R}^{m \times n}$ that is semi-orthogonal, i.e., $W^T W = I_n$. Note that $W \in \text{St}(m, n)$, the Stiefel manifold of $m \times n$ semi-orthogonal matrices. Given a &ldquo;raw gradient&rdquo; or differential $G \in \mathbb{R}^{m \times n}$, we want to find the steepest descent direction on the Stiefel manifold, i.e., we want to find a matrix $A^* \in \mathbb{R}^{m \times n}$ such that,
$$A^* = \arg\max_{\| A \|_{2 \to 2} = 1} \text{tr}(G^T A) \quad \text{s.t. } W^T A + A^T W = 0.$$
In words, we want to find a unit spectral norm matrix $A$ that is in the tangent space at $W$ and maximizes the &ldquo;alignment&rdquo; with the raw gradient $G$.</p>
<h2 id="equivalence-between-bernsteins-and-sus-solutions">Equivalence between Bernstein&rsquo;s and Su&rsquo;s solutions<a hidden class="anchor" aria-hidden="true" href="#equivalence-between-bernsteins-and-sus-solutions">#</a></h2>
<p>Bernstein (2025) and Su (2025) found the following solutions to the square and full-rank case,</p>
<p>$$\begin{align*}
A^*_{\text{bernstein}} &amp;= W \texttt{msign}(\texttt{skew}(W^TG))\\
A^*_{\text{su}} &amp;= \texttt{msign}(G - W\texttt{sym}(W^T G))
\end{align*}$$</p>
<p>We will show that these are equivalent, i.e., $A^*_{\text{bernstein}} = A^*_{\text{su}}$. For this, we will reuse the following proposition we have discussed in a <a href="../spectral-clipping">previous post on spectral clipping</a>.</p>
<blockquote>
<p><strong>Proposition1 (Transpose Equivariance and Unitary Multiplication Equivariance of Odd Matrix Functions)</strong>. Let $W \in \mathbb{R}^{m \times n}$ and $W = U \Sigma V^T$ be its reduced SVD. And let $f: \mathbb{R}^{m \times n} \to \mathbb{R}^{m \times n}$ be an odd analytic matrix function that acts on the singular values of $W$ as follows,
$$f(W) = U f(\Sigma) V^T.$$
Then $f$ is equivariant under transposition and unitary multiplication, i.e.,
$$f(W^T) = f(W)^T \quad\text{and}\quad f(WQ^T) = f(W)Q^T \quad\text{and}\quad f(Q^TW) = Q^Tf(W)$$
for all $Q \in \mathbb{R}^{m \times n}$ such that $Q^TQ = I$.</p>
</blockquote>
<p>Thus,</p>
<p>$$\begin{align*}
A^*_{\text{bernstein}}
&amp;= W \texttt{msign}(\texttt{skew}(W^TG)) \\
&amp;= \texttt{msign}(W \texttt{skew}(W^TG)) &amp;\text{(from Proposition 1)} \\
&amp;= \texttt{msign}\left(\frac{1}{2}W W^T G - \frac{1}{2}W G^T W \right) \\
&amp;= \texttt{msign}\left(W W^T G - \frac{1}{2}W W^T G - \frac{1}{2}W G^T W \right) \\
&amp;= \texttt{msign}\left(G - W\texttt{sym}(W^T G) \right) \\
A^*_{\text{bernstein}} &amp;= A^*_{\text{su}}
\end{align*}$$
where the second-to-last equality relies on $W$ being square and full-rank (which then implies that $W W^T = I_m$).</p>
<h2 id="projection-projection-perspective">Projection-projection perspective<a hidden class="anchor" aria-hidden="true" href="#projection-projection-perspective">#</a></h2>
<p>One can interpret Bernstein&rsquo;s and Su&rsquo;s solutions as a two-step projection process:</p>
<ol>
<li>(Orthogonal) projection to the tangent space at $W$; and</li>
<li>Projection to the closest semi-orthogonal matrix.</li>
</ol>
<p>This is because the map $G \to G - W \texttt{sym}(W^T G)$ is actually the orthogonal projection onto the tangent space at $W$ and that $\texttt{msign}$ projects the resulting matrix to the closest semi-orthogonal matrix. We present these more rigorously as follows.</p>
<blockquote>
<p><strong>Theorem 2 (Orthogonal projection to the tangent space at $W$).</strong> Let $W \in \text{St}(m, n)$ be a point on the Stiefel manifold. The projection of a vector $V \in \mathbb{R}^{m \times n}$ onto the tangent space at $W$, denoted as $T_W\text{St}(m, n)$ , is given by,
$$\begin{equation}
\texttt{proj}_{T_W\text{St}(m, n)}(V) = V - W \text{sym}(W^T V)
\end{equation}$$</p>
</blockquote>


<p><details >
  <summary markdown="span">Show <strong>proof of Theorem 2</strong></summary>
  <blockquote>
<p><strong>Proof.</strong> First, we need to show that the normal space at $W$, $\text{NS}_W$ is given by,
$$\text{NS}_W = \{WS | S = S^T\}$$
for symmetric $S$. To show this, let $A \in T_W\text{St}(m, n)$ be an arbitrary tangent vector at $W$. Then we have,
$$\begin{align*}
\langle A, WS \rangle &amp;= \text{tr}(A^T WS) \\
&amp;= \text{tr}(S W^T A) &amp;\text{(transpose invariance of trace)} \\
&amp;= -\text{tr}(S A^T W) &amp;\text{(since $A \in T_W\text{St}(m, n)$)} \\
&amp;= -\text{tr}(A^T W S) &amp;\text{(cyclic property of trace)} \\
\langle A, WS \rangle &amp;= -\langle A, WS \rangle
\end{align*}$$
Thus $\langle A, WS \rangle = 0$ which implies that $A$ and $WS$ are orthogonal. Hence $WS \in \text{NS}_W$.</p>
<p>Now, for any $V \in \mathbb{R}^{m \times n}$, we can write it as,
$V = \underbrace{V - WS}_{\text{candidate tangent}} + \underbrace{WS}_{\text{candidate normal}}$ for some symmetric $S$. To find $S$,
$$\begin{align*}
W^T (V - WS) + (V - WS)^T W &amp;= 0 \\
W^T V - S + V^TW - S &amp;= 0 \\
S &amp;= \text{sym}(W^T V)
\end{align*}$$
Thus, $V - W \text{sym}(W^T V) \in T_W\text{St}(m, n)$. And because of that, $W^T (V - W \text{sym}(W^T V))$ must be skew-symmetric. Thus,
$$\begin{equation*}
\langle V - WS, WS \rangle
= \langle \underbrace{W^T (V - WS)}_{\text{skew-symmetric}}, \underbrace{S}_{\text{symmetric}} \rangle
= 0
\end{equation*}$$
Hence, $V - W \text{sym}(W^T V)$ is the orthogonal projection of $V$ onto the tangent space at $W$.</p>
</blockquote>

</details></p>

<p>And from Proposition 4 of Bernstein &amp; Newhouse (2024),</p>
<blockquote>
<p><strong>Proposition 3 (Projection to the closest semi-orthogonal matrix).</strong> Consider the orthogonal matrices $\mathcal{O}_{m \times n} := \{ A \in \mathbb{R}^{m \times n} : A A^T = I_m or A^T A = I_n \}$ and let $\| \cdot \|_F$ denote the Frobenius norm. For any matrix $G \in R^{m \times n}$ with reduced SVD $G = U \Sigma V^T$:
$$\arg\min_{A \in \mathcal{O}_{m \times n}} \| A - G \|_F = \texttt{msign}(G) = UV^T,$$
where the minizer $UV^T$ is unique if and only if the matrix $G$ has full rank.</p>
</blockquote>
<p>Thus we can write,
$$A^*_{\text{bernstein}} = A^*_{\text{su}} = (\texttt{msign} \circ \texttt{proj}_{T_W\text{St}(m, n)})(G)$$</p>
<h3 id="why-bernsteins--sus-solutions-only-work-for-the-square-and-full-rank-case">Why Bernstein&rsquo;s &amp; Su&rsquo;s solutions only work for the square and full-rank case<a hidden class="anchor" aria-hidden="true" href="#why-bernsteins--sus-solutions-only-work-for-the-square-and-full-rank-case">#</a></h3>
<p>Note that the projections above aim to guarantee both of our criteria for the solution, but one step at a time. And that the $\texttt{msign}$ after the projection may send the resulting matrix outside the tangent space at $W$. We show that this is not a problem in the square and full-rank case, but it is in the general case.</p>
<table>
<thead>
<tr>
<th>operation</th>
<th style="text-align:right">on the tangent space at $W$?</th>
<th style="text-align:right">have unit spectral norm?</th>
</tr>
</thead>
<tbody>
<tr>
<td>(input $G$)</td>
<td style="text-align:right">not in general</td>
<td style="text-align:right">not in general</td>
</tr>
<tr>
<td>1st projection ($\texttt{proj}_{T_W St(m, n)}(\cdot)$)</td>
<td style="text-align:right">${\color{green}\text{yes}}$</td>
<td style="text-align:right">not necessarily</td>
</tr>
<tr>
<td>2nd projection ($\texttt{msign}(\cdot$))</td>
<td style="text-align:right">only for the square<br>and full-rank case</td>
<td style="text-align:right">${\color{green}\text{yes}}$</td>
</tr>
</tbody>
</table>
<p>To demonstrate this, we will need the following proposition.</p>
<blockquote>
<p><strong>Proposition 4 ($\texttt{msign}$ preserves skew-symmetry).</strong> Let $X \in \R^{m \times n}$ be a skew-symmetric matrix. Then $\texttt{msign}(X)$ is also skew-symmetric.</p>
</blockquote>
<p>The proof follows directly from the transpose equivariance and oddness of $\texttt{msign}$, i.e., $\texttt{msign}(X) = \texttt{msign}(-X^T) = -\texttt{msign}(X)^T$.</p>
<p>Also note that for the general case,
$$\begin{equation}
WW^T + QQ^T = I_m \quad\text{and}\quad W^T Q = 0
\end{equation}$$
where $Q$ is the orthogonal complement of $W$.</p>
<p>Thus,
$$\begin{align*}
(\texttt{msign}\circ \texttt{proj}_{T_W St(m, n)})(G)
&amp;= \texttt{msign}(G - \frac{1}{2}W W^T G - \frac{1}{2} W G^T W) \\
&amp;= \texttt{msign}((WW^T + QQ^T)G - \frac{1}{2}W W^T G - \frac{1}{2} W G^T W) \\
&amp;= \texttt{msign}(W \texttt{skew}(W^T G) + QQ^T G)
\end{align*}$$
For the square and full-rank case, we have $Q = 0$. And the above simplifies to Berstein&rsquo;s solution,
$$(\texttt{msign}\circ \texttt{proj}_{T_W St(m, n)})(G) = W \texttt{msign}(\texttt{skew}(W^T G))$$
and since $\texttt{skew}(W^T G)$ is skew-symmetric, then $\texttt{msign}(\texttt{skew}(W^T G))$ must be too. And thus,
$$\begin{align*}
&amp;W^T (\texttt{msign}\circ \texttt{proj}_{T_W St(m, n)})(G) + (\texttt{msign}\circ \texttt{proj}_{T_W St(m, n)})(G)^T W \\
&amp;\qquad= W^T W \texttt{msign}(\texttt{skew}(W^T G)) + (W\texttt{msign}(\texttt{skew}(W^T G)))^T W \\
&amp;\qquad= \texttt{msign}(\texttt{skew}(W^T G)) + \texttt{msign}(\texttt{skew}(W^T G))^T \\
&amp;\qquad= 0
\end{align*}$$
Hence for the square and full-rank case, this two-step projection process guarantees that the resulting matrix has unit spectral norm <em>and</em> is in the tangent space at $W$.</p>
<p>For the more general case, we have $Q \neq 0$. Thus, we cannot guarantee that $W \texttt{skew}(W^T G) + QQ^T G$ is skew-symmetric. And so the $\texttt{msign}$ after the projection may send the resulting matrix outside the tangent space at $W$.</p>
<h3 id="heuristic-solution-for-the-general-case-under-construction">Heuristic solution for the general case [Under Construction]<a hidden class="anchor" aria-hidden="true" href="#heuristic-solution-for-the-general-case-under-construction">#</a></h3>
<p>Notice that $QQ^T G$ is the projection of $G$ onto the column space of $Q$, $\texttt{proj}_{\text{col}(Q)}(G) = QQ^T G$. One can think of this as the component of $G$ that is not in the span of $W$. In practice, this is typically small relative to the component of $G$ that <em>is</em> in the span of $W$. If so, then,
$$(\texttt{msign}\circ \texttt{proj}_{T_W St(m, n)})(G) \approx \texttt{msign}(W \texttt{skew}(W^T G) + \cancel{\texttt{proj}_{\text{col}(Q)}(G)})$$
which means that while the resulting matrix after the two projections may not be in the tangent space at $W$, it would likely be <em>nearby</em>. And repeating this process a few times should close the gap.</p>
<p>Here&rsquo;s a sample implementation,</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a">def</span> <span style="color:#0a0">project_to_stiefel_tangent_space</span>(X, delta_X):
</span></span><span style="display:flex;"><span>    <span style="color:#00a">return</span> delta_X - X @ sym(X.T @ delta_X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a">def</span> <span style="color:#0a0">orthogonalize</span>(X):
</span></span><span style="display:flex;"><span>    <span style="color:#aaa;font-style:italic"># copy Newton-Schulz iteration from Muon (Jordan et al., 2024)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a">def</span> <span style="color:#0a0">steepest_descent_stiefel_manifold_heuristic</span>(W, G, num_steps=<span style="color:#099">1</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#00a">assert</span> num_steps &gt; <span style="color:#099">0</span>, <span style="color:#a50">&#34;Number of steps must be positive&#34;</span>
</span></span><span style="display:flex;"><span>    A_star = G
</span></span><span style="display:flex;"><span>    <span style="color:#00a">for</span> _ <span style="color:#00a">in</span> <span style="color:#0aa">range</span>(num_steps):
</span></span><span style="display:flex;"><span>        A_star = project_to_stiefel_tangent_space(W, A_star)
</span></span><span style="display:flex;"><span>        A_star = orthogonalize(A_star)
</span></span><span style="display:flex;"><span>    <span style="color:#00a">return</span> A_star
</span></span></code></pre></div><h2 id="results-under-construction">Results [Under Construction]<a hidden class="anchor" aria-hidden="true" href="#results-under-construction">#</a></h2>
<p><img loading="lazy" src="/ponder/steepest-descent-stiefel/steepest-descent-stiefel.png"></p>
<h2 id="how-to-cite">How to cite<a hidden class="anchor" aria-hidden="true" href="#how-to-cite">#</a></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bibtex" data-lang="bibtex"><span style="display:flex;"><span><span style="color:#0a0;text-decoration:underline">@misc</span>{cesista2025spectralclipping,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">author</span> = <span style="color:#a50">{Franz Louis Cesista}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">title</span> = <span style="color:#a50">{&#34;A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold&#34;}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">year</span> = <span style="color:#a50">{2025}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">url</span> = <span style="color:#a50">{http://leloykun.github.io/ponder/steepest-descent-stiefel/}</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>If you find this post useful, please consider supporting my work by sponsoring me on GitHub: <a href="https://github.com/sponsors/leloykun" target="_blank"><img alt="Sponsor on GitHub" loading="lazy" src="https://img.shields.io/badge/%F0%9F%A4%9D-Sponsor%20me-1da1f2?logo=github&style=flat-square"></a></p>
</blockquote>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ol>
<li>Jeremy Bernstein (2025). Orthogonal manifold. URL <a href="https://docs.modula.systems/algorithms/manifold/orthogonal/" target="_blank">https://docs.modula.systems/algorithms/manifold/orthogonal/</a></li>
<li>Jianlin Su (2025). Steepest descent on Stiefel manifold. URL <a href="https://x.com/YouJiacheng/status/1945522729161224532" target="_blank">https://x.com/YouJiacheng/status/1945522729161224532</a></li>
<li>Jeremy Bernstein, Laker Newhouse (2024). Old Optimizer, New Norm: An Anthology. URL <a href="https://arxiv.org/abs/2409.20325" target="_blank">https://arxiv.org/abs/2409.20325</a></li>
<li>Keller Jordan, Yuchen Jin, Vlado Boza, Jiacheng You, Franz Cesista, Laker Newhouse, and Jeremy Bernstein (2024). Muon: An optimizer for hidden layers in neural networks. Available at: <a href="https://kellerjordan.github.io/posts/muon/" target="_blank">https://kellerjordan.github.io/posts/muon/</a></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://leloykun.github.io/tags/machine-learning/">Machine Learning</a></li>
      <li><a href="https://leloykun.github.io/tags/optimizers/">Optimizers</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on x"
            href="https://x.com/intent/tweet/?text=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold&amp;url=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f&amp;hashtags=MachineLearning%2cOptimizers">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f&amp;title=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold&amp;summary=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold&amp;source=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f&title=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on whatsapp"
            href="https://api.whatsapp.com/send?text=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold%20-%20https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on telegram"
            href="https://telegram.me/share/url?text=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold&amp;url=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share A Simple Heuristic Solution for Steepest Descent on Stiefel Manifold on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=A%20Simple%20Heuristic%20Solution%20for%20Steepest%20Descent%20on%20Stiefel%20Manifold&u=https%3a%2f%2fleloykun.github.io%2fponder%2fsteepest-descent-stiefel%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://leloykun.github.io/">Franz Louis Cesista</a></span> ·     
    <span>
    Powered by 
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/pmichaillat/hugo-website/" rel="noopener" target="_blank">a modified version</a>
         of 
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>
</html>
